# MeTube with Persistence Configuration
#
# This configuration enables persistent storage for MeTube downloads,
# which allows videos to persist across pod restarts and upgrades.
# Suitable for development, staging, and production environments.
#
# Usage:
#   helm install metube codefuturist/metube -f values-with-persistence.yaml

# =============================================================================
# Persistence Configuration
# =============================================================================
persistence:
  # Downloads directory - stores all downloaded videos
  downloads:
    # Enable persistent storage
    enabled: true

    # Storage class (leave empty to use default)
    storageClassName: ""

    # Access mode
    accessMode: ReadWriteOnce

    # Storage size - adjust based on your needs
    size: 50Gi

    # Annotations for the PVC (optional)
    annotations:
      backup.velero.io/backup-volumes: "downloads"

  # Temp directory - used during download processing
  temp:
    enabled: true
    storageClassName: ""
    accessMode: ReadWriteOnce
    size: 10Gi

# =============================================================================
# MeTube Configuration
# =============================================================================
metube:
  # Download behavior
  downloadMode: sequential

  # Output template for organized storage
  outputTemplate: "%(uploader)s/%(title)s.%(ext)s"

  # Default format selection
  defaultFormat: "bestvideo+bestaudio/best"

# =============================================================================
# Optional: Resource Configuration
# =============================================================================
resources:
  limits:
    cpu: 2000m
    memory: 1Gi
  requests:
    cpu: 500m
    memory: 512Mi
# =============================================================================
# Storage Tips
# =============================================================================
# - Monitor storage usage regularly
# - Use quality-controlled formats to manage space
# - Consider using a storage class with good performance
# - Set up automated cleanup scripts if needed
# - For high-volume usage, increase size to 100Gi or more
