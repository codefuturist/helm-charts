# Example: Recovery from Full Backup
# Use this configuration to restore PostgreSQL from a backup

# =====================================================================
# Recovery Configuration
# =====================================================================

recovery:
  # Enable recovery mode
  enabled: true

  # Recovery mode: 'full' (full backup only) or 'pitr' (point-in-time recovery)
  mode: "full"

  # Recovery source: 'backup' (PVC) or 's3'
  source: "backup"

  # Optional: Specify exact backup file to restore
  # If not specified, uses the latest backup
  # backupFile: "backup-2024-11-12-02-00-00.sql.gz"
  backupFile: ""

  # Temporary storage size for recovery process
  # Should be >= your database size
  tempStorageSize: "50Gi"

# =====================================================================
# Basic PostgreSQL Configuration
# =====================================================================

postgresql:
  enabled: true
  database: "postgres"
  username: "postgres"

# =====================================================================
# Persistence
# =====================================================================

persistence:
  enabled: true
  size: 20Gi

# =====================================================================
# Backup Configuration (Required for Recovery)
# =====================================================================

backup:
  enabled: true

  persistence:
    enabled: true
    size: 50Gi

# =====================================================================
# Deployment Type
# =====================================================================

deployment:
  type: "statefulset"
  replicaCount: 1
# =====================================================================
# Instructions
# =====================================================================

# 1. Review the recovery configuration above
# 2. Install/upgrade with recovery enabled:
#    helm upgrade my-postgres . -f examples/values-recovery-full.yaml
# 3. Monitor recovery progress:
#    kubectl logs -f job/my-postgres-postgresql-recovery
# 4. After successful recovery, disable recovery mode:
#    Set recovery.enabled: false
#    helm upgrade my-postgres . -f values.yaml
