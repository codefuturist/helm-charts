suite: paperless-secret
templates:
  - secret.yaml
tests:
  - it: creates secret with inline credentials
    set:
      config.secretKey: my-secret
    asserts:
      - isKind:
          of: Secret
      - equal:
          path: metadata.name
          value: RELEASE-NAME-paperless-ngx
      - equal:
          path: data.secret-key
          value: bXktc2VjcmV0

  - it: includes admin password when provided
    set:
      config.secretKey: another-secret
      config.adminPassword: adminpass
    asserts:
      - equal:
          path: data.admin-password
          value: YWRtaW5wYXNz

  - it: skips managed secret when existing one is referenced
    set:
      config.existingSecret: external-secret
    asserts:
      - hasDocuments:
          count: 0
