suite: test postgresql service
templates:
  - service.yaml
tests:
  - it: should create service with default values
    asserts:
      - isKind:
          of: Service
      - equal:
          path: metadata.name
          value: RELEASE-NAME-postgresql
      - equal:
          path: spec.type
          value: ClusterIP
      - equal:
          path: spec.ports[0].port
          value: 5432

  - it: should support NodePort service type
    set:
      service.type: NodePort
      service.nodePort: 30432
    asserts:
      - equal:
          path: spec.type
          value: NodePort
      - equal:
          path: spec.ports[0].nodePort
          value: 30432

  - it: should support LoadBalancer service type
    set:
      service.type: LoadBalancer
      service.loadBalancerIP: "192.168.1.100"
    asserts:
      - equal:
          path: spec.type
          value: LoadBalancer
      - equal:
          path: spec.loadBalancerIP
          value: "192.168.1.100"

  - it: should add custom annotations
    set:
      service.annotations:
        example.com/annotation: "value"
    asserts:
      - equal:
          path: metadata.annotations["example.com/annotation"]
          value: "value"
