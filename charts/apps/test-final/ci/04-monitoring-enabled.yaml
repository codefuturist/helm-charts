# CI Test: Monitoring enabled
# Tests ServiceMonitor, PrometheusRule, HPA, and PDB

monitoring:
  serviceMonitor:
    enabled: true
    interval: 30s
    scrapeTimeout: 10s
    labels:
      release: prometheus
    metricRelabelings:
      - sourceLabels: [__name__]
        action: keep
        regex: "app_.*"

  prometheusRule:
    enabled: true
    labels:
      release: prometheus
    rules:
      - alert: AppDown
        expr: up{job="app"} == 0
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "Application is down"
          description: "Application {{ $labels.instance }} is down"

hpa:
  enabled: true
  minReplicas: 2
  maxReplicas: 5
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80

pdb:
  enabled: true
  minAvailable: 1

controller:
  replicas: 2

resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 128Mi

