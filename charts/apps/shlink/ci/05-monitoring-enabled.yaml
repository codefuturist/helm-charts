# CI Test: Monitoring and autoscaling enabled
# Tests ServiceMonitor, PrometheusRule, and HPA

shlink:
  defaultDomain: "short.example.com"
  initialApiKey: "test-api-key"

postgresql:
  enabled: true
  auth:
    password: "test123"

monitoring:
  serviceMonitor:
    enabled: true
    interval: 30s
    scrapeTimeout: 10s
    metricRelabelings:
      - sourceLabels: [__name__]
        regex: "go_.*"
        action: drop

  prometheusRule:
    enabled: true
    rules:
      - alert: ShlinkDown
        expr: up{job="shlink"} == 0
        for: 5m
        labels:
          severity: critical

autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 5
  targetCPU: 80

pdb:
  enabled: true
  minAvailable: 1

persistence:
  enabled: false
