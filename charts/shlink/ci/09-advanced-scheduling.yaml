# CI Test: Advanced scheduling
# Tests topology spread, affinity, and DNS configuration

shlink:
  defaultDomain: "short.example.com"
  initialApiKey: "test-api-key"

postgresql:
  enabled: true
  auth:
    password: "test123"

controller:
  replicaCount: 2

topologySpreadConstraints:
  - maxSkew: 1
    topologyKey: topology.kubernetes.io/zone
    whenUnsatisfiable: ScheduleAnyway
    labelSelector:
      matchLabels:
        app.kubernetes.io/name: shlink

affinity:
  podAntiAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchLabels:
            app.kubernetes.io/name: shlink
        topologyKey: kubernetes.io/hostname

dnsPolicy: ClusterFirst
dnsConfig:
  options:
    - name: ndots
      value: "2"

hostAliases:
  - ip: "10.0.0.1"
    hostnames:
      - "db.example.com"

persistence:
  enabled: false
